# You Only Look Once (YOLO)
The object detector data and code necessary to train and create a detector which can locate the channel paths within the images generated by 'YOLOImagGen.m'. 

## Labelled Data
The labelled data for training the path object detector is split into two parts. The spots{x}.mat files contain the ground truth data for the bounded boxes of their respective image folders spots_images_{x}.

1. spots.mat and spots_images - The first round of labelled data. Not the best for training as the ground truth bounding boxes were draw too close to the channel paths producing an incomplete detector.

2. spots2.mat and spots_images_2 - The second round of labelled data. Same issue as the first training set.

3+4+5. The final 3 sets produce object detectors with a much higher precision.

When labelled data it is key to create the label large enough to capture the majority of the path in the bounding box. The image size is also squeezed to a smaller size, so the bounding boxes will shrink too and must still cover the paths.

## Training a Detector
1. Ensure the working directory of Matlab is in the YOLO folder.
2. The variables 'train' and 'threshold' at the top of 'YOLO_star_detector.m' will change how the script will run. The 'train' variable will train a new object detector if set to true using the labelled data that is contained in the 'GroundTruthData' and 'ImageFolders'. The threshold variable modifies the threshold for detection by the trained object detector. Decreasing the value will cause the detector to detect more paths within the images, whereas increasing will do the opposite.

For more information on the training please see the following resources below. These resources were used in the construction and training of the network.

Training Options: https://www.mathworks.com/help/deeplearning/ref/trainingoptions.html

YOLOv3: https://www.mathworks.com/help/vision/ug/object-detection-using-yolo-v3-deep-learning.html

YOLOv2: https://www.mathworks.com/help//deeplearning/ug/object-detection-using-yolo-v2.html

The detector uses the darknet-53 deep convolution neural network which is the backbone for the YOLOv3. Although some of the training and object detection functions in Matlab's YOLOv3 has still not be completely implemented in 2021a so some of the layers and functions from YOLOv2 have been used to create a complete network.